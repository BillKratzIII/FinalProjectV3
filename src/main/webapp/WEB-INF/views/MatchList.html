<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Convo Cafe | Match List</title>            
        <!-- Latest Bootstrap min CSS -->
         <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/business-casual.css" rel="stylesheet"> 
    <link rel="stylesheet" href="css/jquery_popup.css" />

	<!-- Custom CSS -->

	<link href="css/dialog.css" rel="stylesheet"> 
	<link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/themes/ui-darkness/jquery-ui.css" rel="stylesheet">  
        <!-- Google Font -->
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,600,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Berkshire+Swash' rel='stylesheet' type='text/css'>      
   

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Josefin+Slab:100,300,400,600,700,100italic,300italic,400italic,600italic,700italic" rel="stylesheet" type="text/css">

    

</head>

<body>
<div class="divBackgroundImage" style="background-image: url(img/worldmap.jpg);">
                    </div>
    <nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <a class="navbar-brand" href="index.html"><img src="img/logo1.png" width = 75px heigth = 75px class="img-circle"/></a>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        
        <li><a href="index.html">Home</a></li>
        <li><a href="profile.html">My Profile</a></li>
        <li><a href="ParticipatingRestaurants.html">Participating Restaurants</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">User Options<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="profile.html">My Profile</a></li>
            <li><a href="UpdateUser.html">Update Profile</a></li>
            <li><a href="DeleteUser.html">Delete Profile</a></li>
          </ul>
        </li>
      </ul>
      
      
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav>
    <!-- Navigation -->
    
  
  
  
  
  
  <section class="main-section">
            <div class="container" >
                <div class="tab-container">
                    <div id="item-one" style="display: block">
                        <div class="row about">
                            <div class="col-md-12 col-sm-12">
                                <div class="well well-lg">
<h1>Matches</h1>

<form>
  
  <div class="dropdown">
  	<label for="firstLanguageId">First Language:</label>
				<select class="form-control" id="firstLanguageId">
					<option value="1">English</option>
					<option value="2">Spanish</option>
					<option value="3">French</option>
					<option value="4">Italian</option>
					<option value="5">German</option>
					<option value="6">Japanese</option>
				</select>
	</div>
	<div class="dropdown">
			<label for="learningLanguageId">Learning Language:</label>
				<select class="form-control" id="learningLanguageId">
					<option value="1">English</option>
					<option value="2">Spanish</option>
					<option value="3">French</option>
					<option value="4">Italian</option>
					<option value="5">German</option>
					<option value="6">Japanese</option>
				</select>
		</div>
  
  
  </form>
  <button class="btn btn-default" id="submitButton">Submit</button>

<br>
<hr>
<br>


	<table id="userMatches" class="table table-striped" border="3">
		<thead>
			<tr>
				<th></th>
  				<th>Name</th>
  				<th>Skill Level</th>
 				<th>Email</th>
			</tr>
		</thead>
		<tbody>
		</tbody>
	
	</table>
<div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
<div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
<div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
  <div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
  <div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
  <div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
  <div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
  <div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
  <div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>
  <div class="well well-sm">
<div class="panel panel-info" role="alert"><a href = "profile.html">
<img src="http://placehold.it/50x50" class="img-responsive" alt="" />
  <div class="panel-heading">Best Match</div></a>
  <div class="panel-body">Bio: Some guy from down the street
  </div>
  </div>
  </div>

</div>
                                
</div><!-- END COL-->
                            
        
    </div>

    </div>       
    </div> 
    </div>      
   



    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-12 text-center">
                    <p>Copyright &copy; CC 2016</p>
                </div>
            </div>
        </div>
    </footer>

	<div id="dialog1" title="Email">

		<form id="emailForm">
			<div class="form-group">
			<label>Email Address:</label><br>
			<input type="email" class="form-control" id="address"><br>
			</div>
			<div class="form-group">
				<label>Subject:</label><br>
				<input type="text" class="form-control" id="subject"><br>
			</div>
			<div class="form-group">
				<label>Message:</label><br>
				<textarea id="message" class="form-control" rows="5"></textarea><br>
			</div>
		</form>
		<button class="btn btn-default" id="emailButton">Submit</button>
	</div>

    <!-- jQuery -->
    <script src="js/jquery.js"></script>
    <script src= "https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    
	<script>
	var matches = new Array();
	var value;
	
	function showForm() {
		console.log("inside showForm");
	    $("#dialog1").dialog();
	    $("#address").val(matches[value-1].email);
	};
	
	
	$(document).ready(function(){
		$("#dialog1").hide();	
		
		
		
		$("#submitButton").click(function(){
			var firstLang = $("#firstLanguageId").val();
			var learnLang = $("#learningLanguageId").val();
			$('#userMatches tbody').remove();
			matches = [];
			
			$.ajax({ 
		    	type: "GET", 
		    	url: "/user", 
		    	data: { get_param: 'value' }, 
		    	dataType: "json",
		    	success: function (data) { 
		    		console.log("checking: " + firstLang + ", " + learnLang);
		    		var trHTML = '';
		    		var i = 1;
		        	$.each(data, function(index, element) {
		        		
		        		console.log(element.name + ", " + element.firstLanguageId + ", " + element.learningLanguageId);
		        		if(firstLang == element.firstLanguageId && learnLang == element.learningLanguageId){
		        				console.log("Match!" + element.name);
		        				matches.push(element);
		        				trHTML += '<tr><td>' + i + '</td><td>' + element.name + '</td><td>' + element.skillLevelId + '</td><td><button onclick="showForm()">Email</button></td></tr>';
		        				i++;
		        		}
		            	
		        	});
		        	$('#userMatches').append(trHTML);
		        	$("#userMatches tr").click(function(){
		 			   $(this).addClass('selected').siblings().removeClass('selected');    
		 			   value=$(this).find('td:first').html();
		 			   console.log(value);    
		 			});
		    	}
			});
			
		});
		
		$("#userMatches tr").click(function(){
			   $(this).addClass('selected').siblings().removeClass('selected');    
			   var value=$(this).find('td:first').html();
			   console.log(value);    
		});
		
		$("#emailButton").click(function(){
			console.log("inside submit button");
			$.ajax({
				url: "/send-mail",
				type:"POST",
				data:JSON.stringify({
					"address" : $("#address").val(),
					"subject" : $("#subject").val(),
					"message" : $("#message").val()
				}),
				contentType:"application/json; charset=utf-8",
				dataType:"json",
				complete: function(){
					console.log("Email Sent?");
					location.href = "/profile.html";
				},
				error: function(){
					console.log("error");
				}
			});
		});
	
	})
	</script>

   
</body>

</html>